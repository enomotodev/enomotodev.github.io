<!DOCTYPE html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--><!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--><!--[if gt IE 8]><!--><html class="no-js"><!--<![endif]--><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><title>enomotodev</title><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta property="og:title" content="enomotodev "><meta property="og:site_name" content="enomotodev"><meta property="og:url" content="http://enomotodev.github.io/"><meta property="og:locale" content="ja_JP"><meta property="og:type" content="website"><link href="http://enomotodev.github.io/index.xml" rel="alternate" type="application/rss+xml" title="enomotodev"><link rel="canonical" href="http://enomotodev.github.io/"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://enomotodev.github.io/touch-icon-144-precomposed.png"><link href="http://enomotodev.github.io/favicon.png" rel="icon"><meta name="generator" content="Hugo 0.18"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="/css/bootswatch/default/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/highlight/dark.css"></head><body><header id="main-header"><nav class="navbar navbar-default navbar-fixed-top"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="http://enomotodev.github.io/">enomotodev</a></div><div id="navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="http://enomotodev.github.io/tags"><i class="fa fa-tags"></i> Tags</a></li></ul></div></div></nav></header><div class="container"><div class="row"><div class="col-sm-12"><div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><div><h2 class="title"><a href="http://enomotodev.github.io/post/install-docker-mac/">Mac に Docker インストールしてみた</a></h2><div class="margin-10"><small><i class="fa fa-calendar"></i> <time datetime="2016-03-28">28 Mar, 2016</time> </small><i class="fa fa-tags"></i> <a href="http://enomotodev.github.io/tags/docker" class="label label-primary">docker</a></div></div><p class="summary">Docker + Docker Machine のインストール まずは、Docker 本体と Docker Machine をインストールします。 Mac だと Docker を直接的に実行できないのですが、Docker Machine を使用すると、一旦VM上で CoreOS や boot2docker を実行して、その上で簡単に Docker を実行できるようになります。 インストール自体はどちらも Homebrew で簡単にインストールすることができます。 $ brew install docker docker-machine Machine の作成 docker-machine コマンドで新しく Machine を作成します。 $ docker-machine create -d virtualbox dev-machine ・・・（省略） Setting Docker configuration on the remote daemon... Checking connection to Docker... Docker is up and running! To see how to connect your Docker Client to the Docker Engine running on this virtual machine, run: docker-machine env dev-machine 上記の dev-machine の部分は Machine の名前になるので、好きな名前をつけてかまいません。</p><p class="lead"><a href="http://enomotodev.github.io/post/install-docker-mac/" class="btn btn-default">Read more &rarr;</a></p></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><div><h2 class="title"><a href="http://enomotodev.github.io/post/install-jenkins/">CentOS に Jenkins インストールしてみた</a></h2><div class="margin-10"><small><i class="fa fa-calendar"></i> <time datetime="2016-02-04">4 Feb, 2016</time> </small><i class="fa fa-tags"></i> <a href="http://enomotodev.github.io/tags/jenkins" class="label label-primary">jenkins</a> <a href="http://enomotodev.github.io/tags/centos" class="label label-primary">centos</a></div></div><p class="summary">はじめに 今まで Jenkins を使う機会はたくさんあったのですが、インストールや設定周りなどをやったことがなかったので、今回 CentOS 6.7 に実際にインストールして軽く触ってみました。 Java をインストールする Jenkins は Java で書かれているので、まずは Java をインストールします。 $ sudo yum install java-1.8.0-openjdk java-1.8.0-openjdk-devel Java がちゃんとインストールできているか確認します。 $ java -version openjdk version &quot;1.8.0_71&quot; OpenJDK Runtime Environment (build 1.8.0_71-b15) OpenJDK 64-Bit Server VM (build 25.71-b15, mixed mode) Jenkins のインストール Java のインストールが確認できたので、Jenkins のインストールに入っていきます。 まずは、Jenkins のレポジトリを追加します。 $ sudo wget -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins-ci.org/redhat/jenkins.repo $ sudo rpm --import http://pkg.jenkins-ci.org/redhat/jenkins-ci.org.key Jenkins のレポジトリを追加できたので、Jenkins をインストールします。 $ sudo yum install jenkins Jenkins の起動 Jenkins のインストールが完了したので、起動させます。</p><p class="lead"><a href="http://enomotodev.github.io/post/install-jenkins/" class="btn btn-default">Read more &rarr;</a></p></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><div><h2 class="title"><a href="http://enomotodev.github.io/post/closure-table/">閉包テーブル（Closure Table）を試してみた</a></h2><div class="margin-10"><small><i class="fa fa-calendar"></i> <time datetime="2015-11-19">19 Nov, 2015</time> </small><i class="fa fa-tags"></i> <a href="http://enomotodev.github.io/tags/database" class="label label-primary">database</a> <a href="http://enomotodev.github.io/tags/mysql" class="label label-primary">mysql</a></div></div><p class="summary">はじめに SQLアンチパターンという本を読んでいたら、再帰的なデータに対して『閉包テーブル（Closure Table）』という考え方があっったので、MySQL 5.6 で試してみました。 再帰的なデータとは、例えば上司を1人までもつことができ、部下は複数持つことができる、下記の組織図のようなツリー構造のデータのことを指します。 テーブル作成 それでは早速テーブルを作成してみましょう。 CREATE TABLE `Employees` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(255) NOT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; CREATE TABLE `TreePaths` ( `ancestor` bigint(20) NOT NULL, `descendant` bigint(20) NOT NULL, PRIMARY KEY (`ancestor`,`descendant`), KEY `descendant` (`descendant`), CONSTRAINT `TreePaths_ibfk_1` FOREIGN KEY (`ancestor`) REFERENCES `Employees` (`id`), CONSTRAINT `TreePaths_ibfk_2` FOREIGN KEY (`descendant`) REFERENCES `Employees` (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; 閉包テーブルでは、Employees テーブルに自分自身の id を親に持つカラムを設けるのではなく、別のテーブルを用いて、ツリー構造の情報を格納します。</p><p class="lead"><a href="http://enomotodev.github.io/post/closure-table/" class="btn btn-default">Read more &rarr;</a></p></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><div><h2 class="title"><a href="http://enomotodev.github.io/post/install-elasticsearch/">Apache &#43; fluentd &#43; Elasticsearch &#43; Kibana を連携させてみた</a></h2><div class="margin-10"><small><i class="fa fa-calendar"></i> <time datetime="2015-11-14">14 Nov, 2015</time> </small><i class="fa fa-tags"></i> <a href="http://enomotodev.github.io/tags/elasticsearch" class="label label-primary">elasticsearch</a> <a href="http://enomotodev.github.io/tags/kibana" class="label label-primary">kibana</a> <a href="http://enomotodev.github.io/tags/fluentd" class="label label-primary">fluentd</a> <a href="http://enomotodev.github.io/tags/ad-agent" class="label label-primary">ad-agent</a> <a href="http://enomotodev.github.io/tags/apache" class="label label-primary">apache</a> <a href="http://enomotodev.github.io/tags/centos" class="label label-primary">centos</a></div></div><p class="summary">Elasticsearch とは Elasticsearch とは2010年に OSS としてリリースされた分散型全文検索サーバです。 実際に CentOS 6.7 にインストールしてつかってみることで Elasticsearch の基本を学んでいきたいと思います。 前回の記事で設定した内容をそのまま使用するので、まだ見てない方はぜひ参照してみてください。 Elasticsearch のインストール Elasticsearch は Java で実装されているので、まずは Java をインストールします。 $ sudo yum install -y java インストールできているか確認します $ java -version openjdk version &quot;1.8.0_65&quot; OpenJDK Runtime Environment (build 1.8.0_65-b17) OpenJDK 64-Bit Server VM (build 25.65-b01, mixed mode) Elasticsearch を yum でインストールするので、レポジトリのGPGキーをインストールします sudo rpm --import https://packages.elastic.co/GPG-KEY-elasticsearch レポジトリを追加します。 /etc/yum.repos.d/elasticsearch.repo [elasticsearch-2.x] name=Elasticsearch repository for 2.x packages baseurl=http://packages.elastic.co/elasticsearch/2.x/centos gpgcheck=1 gpgkey=http://packages.elastic.co/GPG-KEY-elasticsearch enabled=1 yum でインストールします。</p><p class="lead"><a href="http://enomotodev.github.io/post/install-elasticsearch/" class="btn btn-default">Read more &rarr;</a></p></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><div><h2 class="title"><a href="http://enomotodev.github.io/post/install-fluentd/">fluentdつかってみた</a></h2><div class="margin-10"><small><i class="fa fa-calendar"></i> <time datetime="2015-11-14">14 Nov, 2015</time> </small><i class="fa fa-tags"></i> <a href="http://enomotodev.github.io/tags/fluentd" class="label label-primary">fluentd</a> <a href="http://enomotodev.github.io/tags/ad-agent" class="label label-primary">ad-agent</a> <a href="http://enomotodev.github.io/tags/apache" class="label label-primary">apache</a> <a href="http://enomotodev.github.io/tags/mongodb" class="label label-primary">mongodb</a> <a href="http://enomotodev.github.io/tags/centos" class="label label-primary">centos</a></div></div><p class="summary">fluentd とは fluentd とはTreasure Dataという会社が開発している、さまざまなログの収集手段を提供するログ管理ツールです。 今回は CentOS 6.7 で実際にインストールしてつかってみることによって基本的な設定を学んでいきたいと思います。 td-agent をインストール td-agent ？ となるかと思いますが、td-agent には以下のものが同梱されています。 Ruby コアライブラリ fluentd とプラグイン つまり、ad-agent の中に fluentd が入っていて、プラグインなども一緒に入っているので、通常は td-agent をインストールします。 インストールにあたっては公式にインストールスクリプトが公開されているので今回はそちらをつかってインストールします。 $ curl -L https://toolbelt.treasuredata.com/sh/install-redhat-td-agent2.sh | sh 起動は次のコマンドでできます。 $ sudo /etc/init.d/td-agent start 設定ファイルの編集 それでは設定ファイルを編集してみましょう。 まずは、ログ収集の設定を行います。なお、デフォルトの設定はすべて削除してしまって問題ありません。 /etc/td-agent/td-agnet.conf &lt;source&gt; # 入力に in_tail プラグインを指定 type tail # 監視するログファイルのパスを指定 path /var/log/httpd/access_log # ログにつけるタグを指定 tag apache.access # 監視するファイルをどの行まで読み込んだかを記録するファイルの指定 pos_file /var/log/td-agent/httpd-access_log.pos # ログの書式を指定 format apache2 &lt;/source&gt; 次に上記の記述の下にログ出力の設定を追記していきます。</p><p class="lead"><a href="http://enomotodev.github.io/post/install-fluentd/" class="btn btn-default">Read more &rarr;</a></p></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><div><h2 class="title"><a href="http://enomotodev.github.io/post/use-goose/">Gooseつかってみた</a></h2><div class="margin-10"><small><i class="fa fa-calendar"></i> <time datetime="2015-11-11">11 Nov, 2015</time> </small><i class="fa fa-tags"></i> <a href="http://enomotodev.github.io/tags/golang" class="label label-primary">golang</a> <a href="http://enomotodev.github.io/tags/goose" class="label label-primary">goose</a> <a href="http://enomotodev.github.io/tags/mysql" class="label label-primary">mysql</a> <a href="http://enomotodev.github.io/tags/migration" class="label label-primary">migration</a></div></div><p class="summary">Gooseとは GooseとはGo言語で作られたDBマイグレーションツールです。 develop環境やproduction環境など各環境に簡単に設定を変更でき、かなり便利そうなので実際にMySQLで試してみました。 Gooseパッケージの取得 まずは go get して Goose パッケージを取得します。 ※ Goをインストールしていない人や、GOPATHを設定していない人は公式ドキュメントを参考に導入してみてください。 $ go get bitbucket.org/liamstask/goose/cmd/goose dbディレクトリの作成 プロジェクトのルート直下に db ディレクトリを作成します。 $ mkdir db configファイルの作成 取得したGooseパッケージのサンプルからconfigファイルをコピーします。 $ cp $GOPATH/src/bitbucket.org/liamstask/goose/db-sample/dbconf.yml db/ configファイルの編集 まずは先ほどコピーしてきたconfigファイルの中身をのぞいてみます。 デフォルトで test / develop / production のそれぞれの環境に PostgreSQL の driver が設定してあるのが、なんとなくわかるかと思います。 db/dbconf.yml test: driver: postgres open: user=liam dbname=tester sslmode=disable development: driver: postgres open: user=liam dbname=tester sslmode=disable production: driver: postgres open: user=liam dbname=tester sslmode=verify-full customimport: driver: customdriver open: customdriver open import: github.</p><p class="lead"><a href="http://enomotodev.github.io/post/use-goose/" class="btn btn-default">Read more &rarr;</a></p></div></div><nav><ul class="pagination"><li><a aria-label="First" href="/"><span aria-hidden="true">&laquo;&laquo;</span></a></li><li><a aria-label="Previous" href="/"><span aria-hidden="true">&laquo;</span></a></li><li><a href="/">1</a></li><li class="active"><a href="/page/2/">2</a></li><li class="disabled"><a aria-label="Next" href="#"><span aria-hidden="true">&raquo;</span></a></li><li class="disabled"><a aria-label="Last" href="/page/2/"><span aria-hidden="true">&raquo;&raquo;</span></a></li></ul></nav></div></div></div><footer class="footer hidden-print"><div class="container"><div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><p></p><div class="pull-left"><a class="toplink" href="#">back to top</a></div><div class="pull-right"></div><p></p></div><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center"><small><div class="container copyright">&copy; 2016 enomotodev</div></small></div></div></div></footer><script src="/js/jquery.min.js"></script><script src="/js/bootstrap.min.js"></script><script type="text/javascript">(function() {
    
    
    if (window.location.hostname == "localhost")
      return;

    var dsq = document.createElement('script'); dsq.async = true; dsq.type = 'text/javascript';
    dsq.src = '//enomotodev.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();</script><script src="/js/highlight.pack.js"></script><script src="/js/site.js"></script><script>hljs.initHighlightingOnLoad();</script><script>var _gaq=[['_setAccount','UA-59438562-2'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));</script></body></html>